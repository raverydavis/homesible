services:
  ryot:
    container_name: {{ ryot_container_name | default('ryot') }}
    image: ghcr.io/ignisda/ryot:{{ ryot_version | default('latest') }}
    restart: {{ ryot_restart_policy | default('unless-stopped') }}
    depends_on:
      {{ ryot_db_container_name | default('ryot-db') }}:
        condition: service_started
        restart: true
    ports:
      - {{ ryot_published_port | default('8001') }}:8000
    env_file: {{ ryot_env_file | default('.secretfile-ryot') }}

  ryot-db:
    container_name: {{ ryot_db_container_name | default('ryot-db') }}
    image: docker.io/library/postgres:{{ ryot_db_version | default('16-alpine') }}
    restart: {{ ryot_db_restart_policy | default('unless-stopped') }}
    env_file: {{ ryot_db_env_file | default('.secretfile-ryot-db') }}
    volumes:
      - {{ ryot_db_path | default('/opt/ryot') }}:/var/lib/postgresql/data